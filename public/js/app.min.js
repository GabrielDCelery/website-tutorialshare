console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","ngStorage","checklist-model","DisplayFactory","DatabaseFactory","FormValidationFactory","TokenFactory","AuthController","LoginController","RegisterController","ResetController","ResetMailController","ListController","AddLogController"]);myApp.config(["$routeProvider","$locationProvider","$httpProvider",function(e,a,t){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/reset",{templateUrl:"views/auth/_resetmail.html",controller:"ResetMailCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).when("/list",{templateUrl:"views/log/_list.html",controller:"ListCtrl"}).when("/add",{templateUrl:"views/log/_add.html",controller:"AddLogCtrl"}).otherwise({redirectTo:"/"}),a.html5Mode(!0),t.interceptors.push("TokenInterceptor")}]),myApp.controller("MainCtrl",["$scope",function(e){}]);var DatabaseFactory=angular.module("DatabaseFactory",[]);DatabaseFactory.factory("Database",["$http",function(e){function a(a,t){e.post("/auth/doesuserexist",a).then(function(e){t(e)})}function t(a,t){e.post("/auth/login",a).then(function(e){t(e)})}function r(a,t){e.post("/auth/register",a).then(function(e){t(e)})}function o(a,t){e.post("/auth/resetmail",a).then(function(e){t(e)})}function s(a,t){e.post("/auth/reset",a).then(function(e){t(e)})}function n(a){e.get("/log/list").then(function(e){a(e)})}function l(a,t){e.post("/log/add",a).then(function(e){t(e)})}return{doesUserExist:a,loginUser:t,registerUser:r,getResetMail:o,resetPassword:s,listLogs:n,addLog:l}}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("Display",[function(){function e(e,a){for(var t in e)t==a?e[t]=!0:e[t]=!1}return{showSelectedElement:e}}]);var FormValidationFactory=angular.module("FormValidationFactory",[]);FormValidationFactory.factory("FormValidation",[function(){function e(e){var a=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);return!!a.test(e)}function a(e){var a=new RegExp(/^[a-zA-Z0-9]*$/);return!!a.test(e)}function t(e){var a=new RegExp(/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/);return!!a.test(e)}function r(e,a){return a<=e.length}function o(e,a){return a<e.length}function s(e,a){return e==a}function n(e,a){for(var t=0;t<a.length;t++)if(e==a[t])return!0;return!1}function l(e){return 0==e.length}function i(e){var a=!0;for(var t in e)1==e[t]&&(a=!1);return a?!0:void 0}function d(e){return"/"!=e.charAt(e.length-1)?e+"/":e}return{isEmailValid:e,isTagValid:a,isUrlValid:t,isInputLongEnough:r,isInputTooLong:o,areInputsMatching:s,duplicateData:n,isArrayEmpty:l,canSendData:i,addBackSlashToUrl:d}}]);var TokenFactory=angular.module("TokenFactory",[]);TokenFactory.factory("TokenInterceptor",["$q","$localStorage",function(e,a){function t(t){return t.headers=t.headers||{},a.token&&(t.headers["X-Access-Token"]=a.token,t.headers["X-Key"]=a.username,t.headers["Content-Type"]="application/json"),t||e.when(t)}function r(a){return a||e.when(a)}return{request:t,response:r}}]);var AddLogController=angular.module("AddLogController",[]);AddLogController.controller("AddLogCtrl",["$scope","Database","FormValidation",function(e,a,t){function r(){e.display.alert.invalidtagformat=!1,e.display.alert.tagtooshort=!1,e.display.alert.duplicatetag=!1,e.display.alert.tagtoolong=!1}function o(a,o){r();var s=e.display.alert.invalidtagformat=!t.isTagValid(a),n=e.display.alert.tagtooshort=!t.isInputLongEnough(a,3),l=e.display.alert.duplicatetag=t.duplicateData(a,o),i=e.display.alert.tagtoolong=t.isInputTooLong(a,20);s||n||l||i||o.push(a.toLowerCase())}function s(e){e.pop()}function n(o){r(),e.display.alert.titletooshort=!t.isInputLongEnough(o.title,8),e.display.alert.titletoolong=t.isInputTooLong(o.title,25);var s=t.addBackSlashToUrl(o.url.trim());e.display.alert.urlnotvalid=!t.isUrlValid(s),e.display.alert.descriptiontooshort=!t.isInputLongEnough(o.description,10),e.display.alert.descriptiontoolong=t.isInputTooLong(o.description,140),e.display.alert.needtags=t.isArrayEmpty(o.tags),t.canSendData(e.display.alert)&&a.addLog(o,function(a){a.data.success?(e.data.success.message=a.data.message,e.display.page.error=!1,e.display.page.success=!0):(e.data.error.message=a.data.message,e.display.page.success=!1,e.display.page.error=!0)})}e.data={form:{title:"",url:"",description:"",addtag:"",tags:[]},success:{message:""},error:{message:""}},e.display={page:{form:!0,success:!1,error:!1},alert:{titletooshort:!1,titletoolong:!1,descriptiontooshort:!1,descriptiontoolong:!1,urlnotvalid:!1,tagtooshort:!1,tagtoolong:!1,invalidtagformat:!1,needtags:!1,duplicatetag:!1}},e.addTag=o,e.addLog=n,e.removeTag=s}]);var ListController=angular.module("ListController",[]);ListController.controller("ListCtrl",["$scope","Database",function(e,a){function t(a){e.listOrder=a,e.reverseList=!e.reverseList}e.logs=[],e.listOrder="title",e.reverseList=!1,e.checklist={logs:[],allChecked:!1},a.listLogs(function(a){console.log(a.data.data),e.logs=a.data.data}),e.orderList=t}]);var AuthController=angular.module("AuthController",[]);AuthController.controller("AuthCtrl",["$scope","$http","$location","$localStorage",function(e,a,t,r){function o(){r.token&&(e.auth.loggedIn=!0,e.auth.username=r.username)}function s(){e.auth.loggedIn=!1,e.auth.username="",delete r.token,delete r.username,t.path("/")}e.auth={loggedIn:!1,username:""},e.logOut=s,o()}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","$localStorage","Display","Database","FormValidation",function(e,a,t,r,o,s){function n(a){e.display.alert.usernamelength=!s.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=!s.isInputLongEnough(e.data.form.password,8),s.canSendData(e.display.alert)&&o.loginUser(a,function(a){e.auth.username=e.data.form.username,t.token=a.data.token,t.username=e.data.form.username,a.data.success?(e.data.success.message=a.data.message,e.auth.loggedIn=!0,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamelength:!1,passwordlength:!1}},e.data={form:{username:"",password:"",rememberme:!1},success:{message:""},error:{message:""}},e.loginUser=n}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","Display","Database","FormValidation",function(e,a,t,r,o){function s(a,t){r.doesUserExist(a,function(a){a.data.success?(e.display.page.error=!1,t()):(e.display.page.error=!0,e.data.error.message=a.data.message)})}function n(a){e.display.alert.emailvalid=!o.isEmailValid(e.data.form.email),e.display.alert.usernamelength=!o.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=!o.isInputLongEnough(e.data.form.password,8),e.display.alert.passwordsmatching=!o.areInputsMatching(e.data.form.password,e.data.form.passwordconfirm),s(a,function(){o.canSendData(e.display.alert)&&r.registerUser(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,usernamelength:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""},success:{message:""},error:{message:""}},e.registerUser=n}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","Display","Database","FormValidation",function(e,a,t,r,o,s){function n(a){a.encrypteduserdata=t.encrypteduserdata,e.display.alert.passwordlength=!s.isInputLongEnough(e.data.form.newpassword,8),e.display.alert.passwordsmatching=!s.areInputsMatching(e.data.form.newpassword,e.data.form.confirmnewpassword),s.canSendData(e.display.alert)&&o.resetPassword(a,function(a){a.data.success?(e.data.success.message=a.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,r.showSelectedElement(e.display.page,"error"))})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{newpassword:"",confirmnewpassword:""},success:{message:""},error:{message:""}},e.resetPassword=n}]);var ResetMailController=angular.module("ResetMailController",[]);ResetMailController.controller("ResetMailCtrl",["$scope","$http","$routeParams","Display","Database","FormValidation",function(e,a,t,r,o,s){function n(a){e.display.alert.emailvalid=!s.isEmailValid(e.data.form.email),s.canSendData(e.display.alert)&&o.getResetMail(a,function(a){a.data.success?(e.data.success.message=a.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1}},e.data={form:{email:""},success:{message:""},error:{message:""}},e.getResetMail=n}]);