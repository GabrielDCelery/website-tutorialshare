console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","ngStorage","DisplayFactory","DatabaseFactory","FormValidationFactory","TokenFactory","AuthController","LoginController","RegisterController","ResetController","ResetMailController","ListController","AddLogController"]);myApp.config(["$routeProvider","$locationProvider","$httpProvider",function(e,t,a){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/reset",{templateUrl:"views/auth/_resetmail.html",controller:"ResetMailCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).when("/list",{templateUrl:"views/log/_list.html",controller:"ListCtrl"}).when("/add",{templateUrl:"views/log/_add.html",controller:"AddLogCtrl"}).otherwise({redirectTo:"/"}),t.html5Mode(!0),a.interceptors.push("TokenInterceptor")}]),myApp.controller("MainCtrl",["$scope",function(e){}]);var DatabaseFactory=angular.module("DatabaseFactory",[]);DatabaseFactory.factory("Database",["$http",function(e){function t(t,a){e.post("/auth/doesuserexist",t).then(function(e){a(e)})}function a(t,a){e.post("/auth/login",t).then(function(e){a(e)})}function r(t,a){e.post("/auth/register",t).then(function(e){a(e)})}function o(t,a){e.post("/auth/resetmail",t).then(function(e){a(e)})}function s(t,a){e.post("/auth/reset",t).then(function(e){a(e)})}function n(t){e.get("/log/list").then(function(e){t(e)})}function l(t,a){e.post("/log/add",t).then(function(e){a(e)})}return{doesUserExist:t,loginUser:a,registerUser:r,getResetMail:o,resetPassword:s,listLogs:n,addLog:l}}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("Display",[function(){function e(e,t){for(var a in e)a==t?e[a]=!0:e[a]=!1}return{showSelectedElement:e}}]);var FormValidationFactory=angular.module("FormValidationFactory",[]);FormValidationFactory.factory("FormValidation",[function(){function e(e){var t=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);return!!t.test(e)}function t(e){var t=new RegExp(/^[a-zA-Z0-9]*$/);return!!t.test(e)}function a(e){var t=new RegExp(/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/);return!!t.test(e)}function r(e,t){return t<=e.length}function o(e,t){return t<e.length}function s(e,t){return e==t}function n(e,t){for(var a=0;a<t.length;a++)if(e==t[a])return!0;return!1}function l(e){return 0==e.length}function i(e){var t=!0;for(var a in e)1==e[a]&&(t=!1);return t?!0:void 0}function d(e){return"/"!=e.charAt(e.length-1)?e+"/":e}return{isEmailValid:e,isTagValid:t,isUrlValid:a,isInputLongEnough:r,isInputTooLong:o,areInputsMatching:s,duplicateData:n,isArrayEmpty:l,canSendData:i,addBackSlashToUrl:d}}]);var TokenFactory=angular.module("TokenFactory",[]);TokenFactory.factory("TokenInterceptor",["$q","$localStorage",function(e,t){function a(a){return a.headers=a.headers||{},t.token&&(a.headers["X-Access-Token"]=t.token,a.headers["X-Key"]=t.username,a.headers["Content-Type"]="application/json"),a||e.when(a)}function r(t){return t||e.when(t)}return{request:a,response:r}}]);var AddLogController=angular.module("AddLogController",[]);AddLogController.controller("AddLogCtrl",["$scope","Database","FormValidation",function(e,t,a){function r(){e.display.alert.invalidtagformat=!1,e.display.alert.tagtooshort=!1,e.display.alert.duplicatetag=!1,e.display.alert.tagtoolong=!1}function o(t,o){r();var s=e.display.alert.invalidtagformat=!a.isTagValid(t),n=e.display.alert.tagtooshort=!a.isInputLongEnough(t,3),l=e.display.alert.duplicatetag=a.duplicateData(t,o),i=e.display.alert.tagtoolong=a.isInputTooLong(t,15);s||n||l||i||o.push(t.toLowerCase())}function s(e){e.pop()}function n(o){r(),e.display.alert.titletooshort=!a.isInputLongEnough(o.title,8),e.display.alert.titletoolong=a.isInputTooLong(o.title,25);var s=a.addBackSlashToUrl(o.url.trim());e.display.alert.urlnotvalid=!a.isUrlValid(s),e.display.alert.descriptiontooshort=!a.isInputLongEnough(o.description,10),e.display.alert.descriptiontoolong=a.isInputTooLong(o.description,140),e.display.alert.needtags=a.isArrayEmpty(o.tags),a.canSendData(e.display.alert)&&t.addLog(o,function(e){console.log(e)})}e.data={form:{title:"",url:"",description:"",addtag:"",tags:[]},success:{message:""},error:{message:""}},e.display={page:{form:!0,success:!1,error:!1},alert:{titletooshort:!1,titletoolong:!1,descriptiontooshort:!1,descriptiontoolong:!1,urlnotvalid:!1,tagtooshort:!1,tagtoolong:!1,invalidtagformat:!1,needtags:!1,duplicatetag:!1}},e.addTag=o,e.addLog=n,e.removeTag=s}]);var ListController=angular.module("ListController",[]);ListController.controller("ListCtrl",["$scope","Database",function(e,t){t.listLogs(function(e){console.log(e.data.data)})}]);var AuthController=angular.module("AuthController",[]);AuthController.controller("AuthCtrl",["$scope","$http","$location","$localStorage",function(e,t,a,r){function o(){r.token&&(e.auth.loggedIn=!0,e.auth.username=r.username)}function s(){e.auth.loggedIn=!1,e.auth.username="",delete r.token,delete r.username,a.path("/")}e.auth={loggedIn:!1,username:""},e.logOut=s,o()}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","$localStorage","Display","Database","FormValidation",function(e,t,a,r,o,s){function n(t){e.display.alert.usernamelength=!s.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=!s.isInputLongEnough(e.data.form.password,8),s.canSendData(e.display.alert)&&o.loginUser(t,function(t){e.auth.username=e.data.form.username,a.token=t.data.token,a.username=e.data.form.username,t.data.success?(e.data.success.message=t.data.message,e.auth.loggedIn=!0,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=t.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamelength:!1,passwordlength:!1}},e.data={form:{username:"",password:"",rememberme:!1},success:{message:""},error:{message:""}},e.loginUser=n}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","Display","Database","FormValidation",function(e,t,a,r,o){function s(t,a){r.doesUserExist(t,function(t){t.data.success?(e.display.page.error=!1,a()):(e.display.page.error=!0,e.data.error.message=t.data.message)})}function n(t){e.display.alert.emailvalid=!o.isEmailValid(e.data.form.email),e.display.alert.usernamelength=!o.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=!o.isInputLongEnough(e.data.form.password,8),e.display.alert.passwordsmatching=!o.areInputsMatching(e.data.form.password,e.data.form.passwordconfirm),s(t,function(){o.canSendData(e.display.alert)&&r.registerUser(t,function(t){t.data.success?(e.data.success.message=t.data.message,a.showSelectedElement(e.display.page,"success")):(e.data.error.message=t.data.message,e.display.page.error=!0)})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,usernamelength:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""},success:{message:""},error:{message:""}},e.registerUser=n}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","Display","Database","FormValidation",function(e,t,a,r,o,s){function n(t){t.encrypteduserdata=a.encrypteduserdata,e.display.alert.passwordlength=!s.isInputLongEnough(e.data.form.newpassword,8),e.display.alert.passwordsmatching=!s.areInputsMatching(e.data.form.newpassword,e.data.form.confirmnewpassword),s.canSendData(e.display.alert)&&o.resetPassword(t,function(t){t.data.success?(e.data.success.message=t.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=t.data.message,r.showSelectedElement(e.display.page,"error"))})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{newpassword:"",confirmnewpassword:""},success:{message:""},error:{message:""}},e.resetPassword=n}]);var ResetMailController=angular.module("ResetMailController",[]);ResetMailController.controller("ResetMailCtrl",["$scope","$http","$routeParams","Display","Database","FormValidation",function(e,t,a,r,o,s){function n(t){e.display.alert.emailvalid=!s.isEmailValid(e.data.form.email),s.canSendData(e.display.alert)&&o.getResetMail(t,function(t){t.data.success?(e.data.success.message=t.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=t.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1}},e.data={form:{email:""},success:{message:""},error:{message:""}},e.getResetMail=n}]);