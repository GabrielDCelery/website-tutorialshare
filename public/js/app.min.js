console.log("app is running...");var myApp=angular.module("myApp",["ngRoute","ngStorage","DisplayFactory","LoginFactory","FormValidationFactory","TokenFactory","LogFactory","AuthController","LoginController","RegisterController","ResetController","ResetMailController","ListController"]);myApp.config(["$routeProvider","$locationProvider","$httpProvider",function(e,a,t){e.when("/",{templateUrl:"views/_main.html",controller:"MainCtrl"}).when("/login",{templateUrl:"views/auth/_login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"views/auth/_register.html",controller:"RegisterCtrl"}).when("/reset",{templateUrl:"views/auth/_resetmail.html",controller:"ResetMailCtrl"}).when("/reset/:encrypteduserdata",{templateUrl:"views/auth/_reset.html",controller:"ResetCtrl"}).when("/list",{templateUrl:"views/log/_list.html",controller:"ListCtrl"}).otherwise({redirectTo:"/"}),a.html5Mode(!0),t.interceptors.push("TokenInterceptor")}]),myApp.controller("MainCtrl",["$scope",function(e){}]);var AuthController=angular.module("AuthController",[]);AuthController.controller("AuthCtrl",["$scope","$http","$location","$localStorage","Login",function(e,a,t,r,o){function s(){r.token&&(e.auth.loggedIn=!0,e.auth.username=r.username)}function n(){e.auth.loggedIn=!1,e.auth.username="",delete r.token,delete r.username,t.path("/")}e.auth={loggedIn:!1,username:""},e.logOut=n,s()}]);var DisplayFactory=angular.module("DisplayFactory",[]);DisplayFactory.factory("Display",[function(){function e(e,a){for(var t in e)t==a?e[t]=!0:e[t]=!1}return{showSelectedElement:e}}]);var TokenFactory=angular.module("TokenFactory",[]);TokenFactory.factory("TokenInterceptor",["$q","$localStorage",function(e,a){function t(t){return t.headers=t.headers||{},a.token&&(t.headers["X-Access-Token"]=a.token,t.headers["X-Key"]=a.username,t.headers["Content-Type"]="application/json"),t||e.when(t)}function r(a){return a||e.when(a)}return{request:t,response:r}}]);var ListController=angular.module("ListController",[]);ListController.controller("ListCtrl",["$scope","Log",function(e,a){a.list(function(e){console.log(e.data)})}]);var LogFactory=angular.module("LogFactory",[]);LogFactory.factory("Log",["$http",function(e){function a(a){e.get("/log/list").then(function(e){a(e)})}return{list:a}}]);var LoginController=angular.module("LoginController",[]);LoginController.controller("LoginCtrl",["$scope","$http","$localStorage","Display","Login","FormValidation",function(e,a,t,r,o,s){function n(a){e.display.alert.usernamelength=s.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=s.isInputLongEnough(e.data.form.password,8),s.canSendData(e.display.alert)&&o.loginUser(a,function(a){e.auth.username=e.data.form.username,t.token=a.data.token,t.username=e.data.form.username,a.data.success?(e.data.success.message=a.data.message,e.auth.loggedIn=!0,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamelength:!1,passwordlength:!1}},e.data={form:{username:"",password:"",rememberme:!1},success:{message:""},error:{message:""}},e.loginUser=n}]);var RegisterController=angular.module("RegisterController",[]);RegisterController.controller("RegisterCtrl",["$scope","$http","Display","Login","FormValidation",function(e,a,t,r,o){function s(a,t){r.doesUserExist(a,function(a){a.data.success?(e.display.page.error=!1,t()):(e.display.page.error=!0,e.data.error.message=a.data.message)})}function n(a){e.display.alert.emailvalid=o.isEmailValid(e.data.form.email),e.display.alert.usernamelength=o.isInputLongEnough(e.data.form.username,5),e.display.alert.passwordlength=o.isInputLongEnough(e.data.form.password,8),e.display.alert.passwordsmatching=o.areInputsMatching(e.data.form.password,e.data.form.passwordconfirm),s(a,function(){o.canSendData(e.display.alert)&&r.registerUser(a,function(a){a.data.success?(e.data.success.message=a.data.message,t.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1,usernamelength:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{email:"",username:"",password:"",passwordconfirm:""},success:{message:""},error:{message:""}},e.registerUser=n}]);var ResetController=angular.module("ResetController",[]);ResetController.controller("ResetCtrl",["$scope","$http","$routeParams","Display","Login","FormValidation",function(e,a,t,r,o,s){function n(a){a.encrypteduserdata=t.encrypteduserdata,e.display.alert.passwordlength=s.isInputLongEnough(e.data.form.newpassword,8),e.display.alert.passwordsmatching=s.areInputsMatching(e.data.form.newpassword,e.data.form.confirmnewpassword),s.canSendData(e.display.alert)&&o.resetPassword(a,function(a){a.data.success?(e.data.success.message=a.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,r.showSelectedElement(e.display.page,"error"))})}e.display={page:{form:!0,success:!1,error:!1},alert:{usernamedoesntexist:!1,passwordwrong:!1,passwordlength:!1,passwordsmatching:!1}},e.data={form:{newpassword:"",confirmnewpassword:""},success:{message:""},error:{message:""}},e.resetPassword=n}]);var ResetMailController=angular.module("ResetMailController",[]);ResetMailController.controller("ResetMailCtrl",["$scope","$http","$routeParams","Display","Login","FormValidation",function(e,a,t,r,o,s){function n(a){e.display.alert.emailvalid=s.isEmailValid(e.data.form.email),s.canSendData(e.display.alert)&&o.getResetMail(a,function(a){a.data.success?(e.data.success.message=a.data.message,r.showSelectedElement(e.display.page,"success")):(e.data.error.message=a.data.message,e.display.page.error=!0)})}e.display={page:{form:!0,success:!1,error:!1},alert:{emailvalid:!1}},e.data={form:{email:""},success:{message:""},error:{message:""}},e.getResetMail=n}]);var FormValidationFactory=angular.module("FormValidationFactory",[]);FormValidationFactory.factory("FormValidation",[function(){function e(e){var a=new RegExp(/^\w+@[a-zA-Z_]+\.[a-zA-Z]{2,3}$/);return!a.test(e)}function a(e,a){return e.length<a}function t(e,a){return e!=a}function r(e){var a=!0;for(var t in e)1==e[t]&&(a=!1);return a?!0:void 0}return{isEmailValid:e,isInputLongEnough:a,areInputsMatching:t,canSendData:r}}]);var LoginFactory=angular.module("LoginFactory",[]);LoginFactory.factory("Login",["$http",function(e){function a(a,t){e.post("/auth/doesuserexist",a).then(function(e){t(e)})}function t(a,t){e.post("/auth/login",a).then(function(e){t(e)})}function r(a,t){e.post("/auth/register",a).then(function(e){t(e)})}function o(a,t){e.post("/auth/resetmail",a).then(function(e){t(e)})}function s(a,t){e.post("/auth/reset",a).then(function(e){t(e)})}return{doesUserExist:a,loginUser:t,registerUser:r,getResetMail:o,resetPassword:s}}]);